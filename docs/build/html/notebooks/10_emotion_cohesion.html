<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>10. Emotion &amp; Metrics Cohesion and Relation &mdash; Jelly-Emo 0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="11. Emotion Count across Networks" href="11_emotion_networks.html" />
    <link rel="prev" title="9. Ordering based on Gradients" href="09_gradient_films_order.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Jelly-Emo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="01_explore-loading.html">1. Exploring the dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="03_dynamic_gradient.html">3. Computing Dynamic Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="04_gradient_metrics.html">4. Extracting Gradients Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="05_gradient_stability.html">5. Sample Gradient Stability</a></li>
<li class="toctree-l1"><a class="reference internal" href="06_personality_index.html">6. Predicting Personality Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="07_gradients_matching.html">7. Matching Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="08_frame-selection.html">8. Frame-Selection based Gradients</a></li>
<li class="toctree-l1"><a class="reference internal" href="09_gradient_films_order.html">9. Ordering based on Gradients</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">10. Emotion &amp; Metrics Cohesion and Relation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Description">Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Table-of-Contents">Table of Contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Example-of-Metrics">Example of Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Correlation-brain-maps-with-7-networks">Correlation brain maps with 7 networks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Correlation-brain-maps-with-regions">Correlation brain maps with regions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Direct-series-visualization-comparison-(check)">Direct series visualization comparison (check)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Loading">Loading</a></li>
<li class="toctree-l3"><a class="reference internal" href="#GLM-Regressors-effect-emotions-and-effect-of-low-level-features">GLM Regressors effect emotions and effect of low-level features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Regressors-Making">Regressors Making</a></li>
<li class="toctree-l4"><a class="reference internal" href="#GLM-Fitting">GLM Fitting</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#GLM-reconstruction-of-emotion-from-metric-regressors">GLM reconstruction of emotion from metric regressors</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Regressor-Making">Regressor Making</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">GLM Fitting</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Reconstruction-of-the-original-emotion-timecourse">Reconstruction of the original emotion timecourse</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Metrics/Regressors-auto-correlation">Metrics/Regressors auto-correlation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#t-statistics-of-Beta-Coefficients">t-statistics of Beta Coefficients</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="11_emotion_networks.html">11. Emotion Count across Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="12_emotion_prediction.html">12. Predicting Emotion Intensity</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Jelly-Emo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">10. Emotion &amp; Metrics Cohesion and Relation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/10_emotion_cohesion.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="10.-Emotion-&amp;-Metrics-Cohesion-and-Relation">
<h1>10. Emotion &amp; Metrics Cohesion and Relation<a class="headerlink" href="#10.-Emotion-&-Metrics-Cohesion-and-Relation" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Description">
<h2>Description<a class="headerlink" href="#Description" title="Permalink to this heading"></a></h2>
<p>We investigate here the relation between emotion timecourses and metrics obtained from dynamic gradients, we mainly use correlation and null distributions ground for supporting relation.</p>
<p>GOAL: Compute correlations (and evaluate strength of correlation) between extracted features from dynamic gradients and emotion timecourses</p>
</section>
<section id="Table-of-Contents">
<h2>Table of Contents<a class="headerlink" href="#Table-of-Contents" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#comparison">Timeseries Comparison</a></p></li>
<li><p><a class="reference external" href="#weightings">GLM</a></p></li>
<li><p><a class="reference external" href="#visualization">Visualization of Correlation and Movie (Side by Side)</a></p></li>
</ul>
<p>### Timeseries Comparison Comparison between item timeseries and centroid of region timeseries</p>
<p>We have choices to either compute correlation between subjects and aggregated emotions or group level and aggregated emotions. We as well introduce other movies for the same subject in order to do permutation testing.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Loading Gradient Example</span>
<span class="n">networks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">index2region</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">moviename</span> <span class="o">=</span> <span class="s1">&#39;Sintel&#39;</span>

<span class="n">G_movie</span><span class="p">,</span> <span class="n">varM</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;./resources/dynamic_grad/group_level414/</span><span class="si">{}</span><span class="s1">_40_grad.pkl&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level/{}_40_1_grad.pkl&#39;.format(moviename))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level414/{}_80_2_grad.pkl&#39;.format(moviename))</span>
<span class="c1"># we keep only first 3 gradients</span>
<span class="n">G_movie</span>  <span class="o">=</span> <span class="n">G_movie</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># 2. Loading Matching Emotion Track</span>
<span class="n">full_df</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/emotion_compileBIDS.csv&#39;</span><span class="p">)</span>
<span class="n">emo_df</span>   <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>
<span class="n">other_df</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>

<span class="c1"># 3. Loading Low-Level Features</span>
<span class="n">luminance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SintelLuminance.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">audio</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SintelAudio.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">diffenerg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SinteldiffNrg.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">k</span>         <span class="o">=</span> <span class="n">G_movie</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="c1"># downsample to rate for window rate</span>
<span class="n">luminance</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">luminance</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">31</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">audio</span>     <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">audio</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ks</span><span class="o">=</span><span class="mi">52</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">diffenerg</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">diffenerg</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">31</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">llf</span>       <span class="o">=</span> <span class="p">[</span><span class="n">luminance</span><span class="p">,</span> <span class="n">audio</span><span class="p">,</span> <span class="n">diffenerg</span><span class="p">]</span>
</pre></div>
</div>
</div>
<section id="Example-of-Metrics">
<h3>Example of Metrics<a class="headerlink" href="#Example-of-Metrics" title="Permalink to this heading"></a></h3>
<p>We use the following 4 metrics: - network variance/position - network volume - intra-network distances - explained variance from eigendecomposition</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="n">pal</span>     <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mi">16</span><span class="p">))</span>

<span class="c1"># METRIC 1</span>
<span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">networks</span><span class="p">)</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">networks</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">R</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>

    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;TR&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distance on gradient space&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Network Volume evolution over time&quot;</span><span class="p">)</span>

<span class="c1"># METRIC 2</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">net2</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">net</span> <span class="o">==</span> <span class="n">net2</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">net</span><span class="p">,</span><span class="n">net2</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">net2</span><span class="p">,</span><span class="n">net</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">):</span>
            <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">net</span><span class="p">,</span><span class="n">net2</span><span class="p">))</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="n">pairs</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
<span class="n">nb</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;PuOr&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">nb</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pairs</span><span class="p">):</span>
    <span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">pair</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">networks_distance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">pair</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">6</span><span class="p">})</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;TR&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Distance on gradient space&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Inter-Network Distances&quot;</span><span class="p">)</span>

<span class="c1"># METRIC 3</span>
<span class="n">nb</span> <span class="o">=</span> <span class="n">varM</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span>
<span class="n">cm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;Spectral&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">nb</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb</span><span class="p">)])</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">gradnb</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">varM</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">3</span><span class="p">)):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">varM</span><span class="p">[:,</span><span class="n">gradnb</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;grad #</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">gradnb</span><span class="p">))</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">8</span><span class="p">})</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;TR&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Eigenvalue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Explained Variance&quot;</span><span class="p">)</span>

<span class="c1"># plt.suptitle(&quot;Metrics evaluations&quot;.format(grad_idx + 1), size=20)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Explained Variance&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_8_1.png" src="../_images/notebooks_10_emotion_cohesion_8_1.png" />
</div>
</div>
<p>Emotions timecourses absolute</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">absemo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/emotion_compileBIDS.csv&#39;</span><span class="p">)</span>
<span class="n">absemo_df</span> <span class="o">=</span> <span class="n">absemo_df</span><span class="p">[</span><span class="n">absemo_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Anger&#39;</span><span class="p">,</span><span class="s1">&#39;Guilt&#39;</span><span class="p">,</span><span class="s1">&#39;WarmHeartedness&#39;</span><span class="p">,</span> \
             <span class="s1">&#39;Disgust&#39;</span><span class="p">,</span><span class="s1">&#39;Happiness&#39;</span><span class="p">,</span><span class="s1">&#39;Fear&#39;</span><span class="p">,</span><span class="s1">&#39;Regard&#39;</span><span class="p">,</span><span class="s1">&#39;Anxiety&#39;</span><span class="p">,</span> \
             <span class="s1">&#39;Satisfaction&#39;</span><span class="p">,</span><span class="s1">&#39;Pride&#39;</span><span class="p">,</span><span class="s1">&#39;Surprise&#39;</span><span class="p">,</span><span class="s1">&#39;Love&#39;</span><span class="p">,</span><span class="s1">&#39;Sad&#39;</span><span class="p">]</span>

<span class="n">NUM_COLORS</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>
<span class="n">cm</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_prop_cycle</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">NUM_COLORS</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NUM_COLORS</span><span class="p">)])</span>

<span class="k">for</span> <span class="n">emotion</span> <span class="ow">in</span> <span class="n">select</span><span class="p">:</span>
    <span class="n">emo_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">absemo_df</span><span class="p">[</span><span class="n">absemo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">emotion</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])[:</span><span class="mi">450</span><span class="p">]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">emotion</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">7</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Aggregated Absolute Emotion time series&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Aggregated Absolute Emotion time series&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_11_1.png" src="../_images/notebooks_10_emotion_cohesion_11_1.png" />
</div>
</div>
</section>
<section id="Correlation-brain-maps-with-7-networks">
<h3>Correlation brain maps with 7 networks<a class="headerlink" href="#Correlation-brain-maps-with-7-networks" title="Permalink to this heading"></a></h3>
<p>Compute correlation between a given metric and emotion series</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grid for each network of correlation with emotions</span>
<span class="n">grad_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">smfactor</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">pairs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">net2</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">net</span> <span class="o">==</span> <span class="n">net2</span><span class="p">:</span> <span class="k">continue</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">net</span><span class="p">,</span><span class="n">net2</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">((</span><span class="n">net2</span><span class="p">,</span><span class="n">net</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">):</span>
            <span class="n">pairs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">net</span><span class="p">,</span><span class="n">net2</span><span class="p">))</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pairs</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>

<span class="n">nb_metric</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">scores</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nb_metric</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>
<span class="n">nscores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nb_metric</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>

<span class="c1"># METRIC 1</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">pair</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">pairs</span><span class="p">)):</span>
    <span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">pair</span>
    <span class="n">y</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">networks_distance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
    <span class="n">ret_score</span><span class="p">,</span> <span class="n">ret_nscore</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">,</span> <span class="n">smfactor</span><span class="o">=</span><span class="n">smfactor</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ret_score</span>
    <span class="n">nscores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_nscore</span>

<span class="c1"># METRIC 2</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">networks</span><span class="p">)):</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">network_variance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">grad_idx</span><span class="p">)</span>
    <span class="n">ret_score</span><span class="p">,</span> <span class="n">ret_nscore</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">,</span> <span class="n">smfactor</span><span class="o">=</span><span class="n">smfactor</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ret_score</span>
    <span class="n">nscores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_nscore</span>

<span class="c1"># METRIC 3</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">networks</span><span class="p">)):</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">R</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
    <span class="n">ret_score</span><span class="p">,</span> <span class="n">ret_nscore</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">,</span> <span class="n">smfactor</span><span class="o">=</span><span class="n">smfactor</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ret_score</span>
    <span class="n">nscores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_nscore</span>

<span class="c1"># METRIC 4</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">networks</span><span class="p">)):</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">varM</span><span class="p">[:,</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">ret_score</span><span class="p">,</span> <span class="n">ret_nscore</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">,</span> <span class="n">smfactor</span><span class="o">=</span><span class="n">smfactor</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ret_score</span>
    <span class="n">nscores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_nscore</span>

<span class="c1"># METRIC 5 -&gt; which is the luminance audio and diff energy values that we want to potentially find correlation with</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tqdm</span><span class="p">(</span><span class="n">networks</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">continue</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">llf</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">ret_score</span><span class="p">,</span> <span class="n">ret_nscore</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">,</span> <span class="n">smfactor</span><span class="o">=</span><span class="n">smfactor</span><span class="p">)</span>
    <span class="n">scores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ret_score</span>
    <span class="n">nscores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_nscore</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 28/28 [27:42&lt;00:00, 59.37s/it]
100%|██████████| 8/8 [19:59&lt;00:00, 149.93s/it]
100%|██████████| 8/8 [36:58&lt;00:00, 277.26s/it]
100%|██████████| 8/8 [18:36&lt;00:00, 139.51s/it]
100%|██████████| 8/8 [13:35&lt;00:00, 101.91s/it]
</pre></div></div>
</div>
</section>
<section id="Correlation-brain-maps-with-regions">
<h3>Correlation brain maps with regions<a class="headerlink" href="#Correlation-brain-maps-with-regions" title="Permalink to this heading"></a></h3>
<p>Compute correlation between a given metric and emotion series</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For each region generate correlation with emotions</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">G_movie</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">m</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">select</span><span class="p">)</span>

<span class="n">scores2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">))</span>

<span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>

<span class="c1">#     y    = np.asarray([ np.sum([points_distance(G_movie[t,idx], G_movie[t,jdx],pmethod=&quot;L2&quot;)</span>
<span class="c1">#                                 for jdx in range(len(G_movie[t,:])) ])</span>
<span class="c1">#             for t in range(len(G_movie))])</span>
    <span class="n">y</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span> <span class="n">points_distance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">,</span><span class="n">idx</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">,:]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">pmethod</span><span class="o">=</span><span class="s2">&quot;L2&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>

    <span class="n">ret_score</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">shift_series_nulldistribution</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">other_df</span><span class="p">,</span> <span class="n">emo_df</span><span class="p">)</span>
    <span class="n">scores2</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">ret_score</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "094820fddebe43e0912de4cf319597c1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<section id="Direct-series-visualization-comparison-(check)">
<h4>Direct series visualization comparison (check)<a class="headerlink" href="#Direct-series-visualization-comparison-(check)" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rowsname = [&#39;exp_var {}&#39;.format(k+1) for k in range(len(networks))]</span>
<span class="c1"># latexify_significancy_table(scores[3][:8], nscores[3][:8], corrflag=True, columnsname=select, rowsname=rowsname)</span>
</pre></div>
</div>
</div>
<p>First example</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span>     <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="s1">&#39;SalVentAttn&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))]))</span>
<span class="n">emo_series</span>   <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="s1">&#39;Happiness&#39;</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">]))</span>
<span class="n">concat_other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other_df</span><span class="p">[</span><span class="n">other_df</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Happiness&#39;</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
<span class="n">ndistrib</span><span class="p">,</span> <span class="n">nstats</span><span class="p">,</span> <span class="n">corr</span> <span class="o">=</span> <span class="n">moviemix_stat_test</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">emo_series</span><span class="p">,</span> <span class="n">concat_other</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">ndistrib</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;null distribution&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">corr</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;initial statistic&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;corr&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;windows #&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;windows #&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_19_1.png" src="../_images/notebooks_10_emotion_cohesion_19_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pal</span>     <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;intra-network metric (M2)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;emotion timecourse&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;M2: SalVenAttn vs Happiness (</span><span class="si">{}</span><span class="s1">=</span><span class="si">{}</span><span class="s1"> &amp; p-value=</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho$&quot;</span><span class="p">,</span> <span class="mf">0.5574</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;M2: SalVenAttn vs Happiness ($\\rho$=0.5574 &amp; p-value=0.006)&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_20_1.png" src="../_images/notebooks_10_emotion_cohesion_20_1.png" />
</div>
</div>
<p>Best few selections</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>

<span class="c1"># 1. compute the index with highest correlation in absolute</span>
<span class="c1"># (we take the 2 largest positive corr and 1 most negative corr for each metric)</span>
<span class="n">indextosee</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">n</span>          <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">scores</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">-</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_metric</span><span class="p">):</span>
    <span class="n">indextosee</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">]]))</span>
<span class="n">indextosee</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">indextosee</span><span class="p">)</span>


<span class="c1"># 2. representative plots</span>
<span class="n">pal</span>     <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_metric</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]:</span>
        <span class="n">colors</span> <span class="o">=</span> <span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cm</span>        <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">PALETTES</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
        <span class="n">cmEmo</span>     <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;hsv&#39;</span><span class="p">)</span>
        <span class="n">colors</span>    <span class="o">=</span> <span class="p">[</span><span class="n">cm</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">28</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">)]</span>
        <span class="n">colorsEmo</span> <span class="o">=</span> <span class="p">[</span><span class="n">cmEmo</span><span class="p">(</span><span class="mf">1.</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="mi">13</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">indextosee</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">a</span><span class="p">,</span><span class="n">b</span> <span class="o">=</span> <span class="n">idx</span><span class="o">//</span><span class="mi">13</span><span class="p">,</span> <span class="n">idx</span><span class="o">%</span><span class="k">13</span>
        <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">p1</span><span class="p">,</span><span class="n">p2</span> <span class="o">=</span> <span class="n">pairs</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
            <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">networks_distance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[:</span><span class="mi">3</span><span class="p">],</span><span class="n">p2</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">y</span>     <span class="o">=</span> <span class="n">network_variance</span><span class="p">(</span><span class="n">G_movie</span><span class="p">,</span> <span class="n">networks</span><span class="p">[</span><span class="n">a</span><span class="p">],</span> <span class="n">grad_idx</span><span class="p">)</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">networks</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">y</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">networks</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
            <span class="n">label</span> <span class="o">=</span> <span class="n">networks</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span>     <span class="o">=</span> <span class="n">varM</span><span class="p">[:,</span><span class="n">a</span><span class="p">]</span>
            <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;grad</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

        <span class="n">z1</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="c1"># z1 = low_pass(z1, ks=40)</span>
        <span class="n">concat_other</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">other_df</span><span class="p">[</span><span class="n">other_df</span><span class="o">.</span><span class="n">item</span> <span class="o">==</span> <span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">]][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
        <span class="n">emo_series</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">]][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
        <span class="n">smoothened</span>   <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="n">smfactor</span><span class="p">)</span>
        <span class="n">z2</span>   <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">smoothened</span><span class="p">[:</span><span class="n">z1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
        <span class="n">z1</span>   <span class="o">=</span> <span class="n">z1</span><span class="p">[:</span><span class="n">z2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">corr</span> <span class="o">=</span> <span class="n">correlation_search</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">nscore</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">moviemix_stat_test</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">,</span> <span class="n">concat_other</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">corr</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">-</span><span class="n">z1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;metric sequence&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;emotion timecourse&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;metric sequence&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">a</span><span class="p">])</span>
            <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">z2</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;emotion timecourse&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;M</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2"> vs </span><span class="si">{}</span><span class="s2"> (</span><span class="si">{}</span><span class="s2">=</span><span class="si">{}</span><span class="s2"> &amp; p-value=</span><span class="si">{}</span><span class="s2">)&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">label</span><span class="p">,</span><span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">],</span><span class="sa">r</span><span class="s2">&quot;$\rho$&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">corr</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">nscore</span><span class="p">,</span><span class="mi">4</span><span class="p">)))</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">m</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Examples of correlations metric vs emotion&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;Examples of correlations metric vs emotion&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_22_1.png" src="../_images/notebooks_10_emotion_cohesion_22_1.png" />
</div>
</div>
<section id="GLM">
<h5>GLM<a class="headerlink" href="#GLM" title="Permalink to this heading"></a></h5>
<p>GLM Analysis with <span class="math notranslate nohighlight">\(\textbf{metric reconstruction}\)</span> and <span class="math notranslate nohighlight">\(\textbf{emotion reconstruction}\)</span> i.e we use as regressors (in turn): - Emotions and low-level features - Metrics</p>
</section>
</section>
</section>
<section id="Loading">
<h3>Loading<a class="headerlink" href="#Loading" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Loading Gradient Example</span>
<span class="n">networks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">index2region</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">moviename</span> <span class="o">=</span> <span class="s1">&#39;Sintel&#39;</span>

<span class="n">G_movie</span><span class="p">,</span> <span class="n">varM</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;./resources/dynamic_grad/group_level414/</span><span class="si">{}</span><span class="s1">_40_grad.pkl&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level_otherparam/{}_40_1_grad.pkl&#39;.format(moviename))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level_otherparam/{}_80_2_grad.pkl&#39;.format(moviename))</span>
<span class="n">G_movie</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># 2. Loading Matching Emotion Track</span>
<span class="n">full_df</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/emotion_compileBIDS.csv&#39;</span><span class="p">)</span>
<span class="n">emo_df</span>   <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>
<span class="n">other_df</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>

<span class="c1"># 3. Loading Low-Level Features</span>
<span class="n">luminance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SintelLuminance.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">audio</span>     <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SintelAudio.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">diffenerg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;./resources/llf-features_extracted/SinteldiffNrg.txt&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">k</span>         <span class="o">=</span> <span class="n">G_movie</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
<span class="c1"># downsample to rate for window rate</span>
<span class="n">luminance</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">luminance</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">31</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">audio</span>     <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">audio</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">ks</span><span class="o">=</span><span class="mi">52</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">diffenerg</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">local_average</span><span class="p">(</span><span class="n">diffenerg</span><span class="p">,</span> <span class="n">ks</span><span class="o">=</span><span class="mi">31</span><span class="p">)[:</span><span class="n">k</span><span class="p">])</span>
<span class="n">llf</span>       <span class="o">=</span> <span class="p">[</span><span class="n">luminance</span><span class="p">,</span> <span class="n">audio</span><span class="p">,</span> <span class="n">diffenerg</span><span class="p">]</span>

<span class="n">n</span><span class="p">,</span> <span class="n">_</span> <span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">G_movie</span><span class="o">.</span><span class="n">shape</span>
<span class="n">n</span>        <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># window reason we resize by -1</span>
</pre></div>
</div>
</div>
</section>
<section id="GLM-Regressors-effect-emotions-and-effect-of-low-level-features">
<h3>GLM Regressors effect emotions and effect of low-level features<a class="headerlink" href="#GLM-Regressors-effect-emotions-and-effect-of-low-level-features" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">luminance</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;luminance energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;audio energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">diffenerg</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;differ energy&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;raw values&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Low-Level Features&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 0.98, &#39;Low-Level Features&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_27_1.png" src="../_images/notebooks_10_emotion_cohesion_27_1.png" />
</div>
</div>
<section id="Regressors-Making">
<h4>Regressors Making<a class="headerlink" href="#Regressors-Making" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">absemo_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/emotion_compileBIDS.csv&#39;</span><span class="p">)</span>
<span class="n">absemo_df</span> <span class="o">=</span> <span class="n">absemo_df</span><span class="p">[</span><span class="n">absemo_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>

<span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">smfactor</span>   <span class="o">=</span> <span class="mi">1</span>
<span class="n">abs_val</span>    <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">select</span><span class="p">)):</span>
    <span class="n">emotion</span>    <span class="o">=</span> <span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
    <span class="n">emotion2</span>   <span class="o">=</span> <span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
    <span class="n">emo_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">emotion</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>

    <span class="n">absemo_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">absemo_df</span><span class="p">[</span><span class="n">absemo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">emotion2</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
    <span class="n">abs_val</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">absemo_series</span><span class="p">)</span>
    <span class="n">smoothened</span> <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="n">smfactor</span><span class="p">)</span>
    <span class="n">z2</span>         <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">smoothened</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>
    <span class="n">regressors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>

<span class="c1"># add regressors for low-level features</span>
<span class="n">regressors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">luminance</span><span class="p">)</span>
<span class="n">regressors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">audio</span><span class="p">)</span>
<span class="n">regressors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">diffenerg</span><span class="p">)</span>
<span class="n">regressors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">regressors</span><span class="p">)</span>
<span class="n">abs_val</span>    <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">abs_val</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="GLM-Fitting">
<h4>GLM Fitting<a class="headerlink" href="#GLM-Fitting" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Obtain ratio of emotion timeseries</span>
<span class="c1"># ratio1 = np.abs(abs_val).mean(axis=1) / np.abs(abs_val).mean(axis=1).sum()</span>

<span class="n">glmnet</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">networks</span><span class="p">)):</span>
    <span class="c1"># Computing to fit series</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">networks</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">y</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># regress solving</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">regressors</span><span class="o">.</span><span class="n">T</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">y</span>

    <span class="n">y_hat_meter</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">P</span><span class="p">)</span>

    <span class="n">sigma_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_hat_meter</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span>
    <span class="n">design_variance_weight</span> <span class="o">=</span> <span class="n">design_variance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># print(&quot;Degrees of freedom: %i&quot; % df)</span>
    <span class="c1"># print(&quot;Sigma-hat (noise) is: %.3f&quot; % sigma_hat)</span>

    <span class="c1"># t-stats</span>
    <span class="n">t_meter</span> <span class="o">=</span> <span class="n">beta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_hat</span> <span class="o">*</span> <span class="n">design_variance_weight</span><span class="p">)</span>

    <span class="c1"># multiply by two to create a two-tailed p-value</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_meter</span><span class="p">])</span>

    <span class="n">glmnet</span><span class="p">[</span><span class="n">networks</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">t_meter</span><span class="p">,</span><span class="n">p_values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rowsname = [&#39;exp_var {}&#39;.format(k+1) for k in range(len(networks))]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="n">select</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Luminance&#39;</span><span class="p">,</span> <span class="s1">&#39;Audio&#39;</span><span class="p">,</span> <span class="s1">&#39;Diffenerg&#39;</span><span class="p">]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">]</span>

<span class="n">statistics</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">glmnet</span><span class="o">.</span><span class="n">values</span><span class="p">()))[:,</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">:]</span>
<span class="n">p_values</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">glmnet</span><span class="o">.</span><span class="n">values</span><span class="p">()))[:,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span><span class="p">:]</span>
<span class="n">latexify_significancy_table</span><span class="p">(</span><span class="n">statistics</span><span class="p">,</span> <span class="n">p_values</span><span class="p">,</span> <span class="n">corrflag</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columnsname</span><span class="o">=</span><span class="n">indexes</span><span class="p">[</span><span class="mi">8</span><span class="p">:],</span>
                            <span class="n">rowsname</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">glmnet</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
\begin{table}
\centering
\caption{Selected stock correlation and simple statistics.}
\begin{tabular}{lllllllll}
\toprule
 &amp; Sati &amp; Prid &amp; Surp &amp; Love &amp; Sad &amp; Lumi &amp; Audi &amp; Diff \\
\midrule
Vis &amp; 0.212 &amp; -1.449 &amp; 0.487 &amp; 0.135 &amp; \bfseries -2.04* &amp; -0.159 &amp; 0.89 &amp; -0.942 \\
SomMot &amp; \bfseries 2.688** &amp; \bfseries -7.234*** &amp; 0.953 &amp; -0.805 &amp; 0.916 &amp; -0.818 &amp; -0.079 &amp; -0.437 \\
DorsAttn &amp; -0.904 &amp; \bfseries 2.359* &amp; -0.326 &amp; 1.549 &amp; \bfseries -4.385*** &amp; -1.903 &amp; 0.286 &amp; -0.018 \\
SalVentAttn &amp; 0.737 &amp; 0.313 &amp; -0.897 &amp; 1.695 &amp; \bfseries 3.018** &amp; -1.114 &amp; 0.076 &amp; 0.614 \\
Limbic &amp; \bfseries 2.515* &amp; \bfseries -2.971** &amp; -0.188 &amp; 0.575 &amp; -1.274 &amp; -1.166 &amp; 0.102 &amp; 0.198 \\
Cont &amp; \bfseries 3.942*** &amp; \bfseries -4.27*** &amp; -1.613 &amp; \bfseries 3.102** &amp; -0.171 &amp; -1.718 &amp; -0.124 &amp; 0.053 \\
Default &amp; 1.536 &amp; \bfseries -5.218*** &amp; -0.196 &amp; -0.033 &amp; 0.064 &amp; -1.943 &amp; -0.122 &amp; -0.019 \\
Sub &amp; 0.922 &amp; -0.287 &amp; -1.157 &amp; 1.681 &amp; 1.929 &amp; -1.584 &amp; 0.86 &amp; -0.208 \\
\bottomrule
\end{tabular}
\end{table}

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vol_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>

<span class="n">indexes</span> <span class="o">=</span> <span class="n">select</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Luminance&#39;</span><span class="p">,</span> <span class="s1">&#39;Audio&#39;</span><span class="p">,</span> <span class="s1">&#39;Diffenerg&#39;</span><span class="p">]</span>
<span class="n">indexes</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="c1"># MAKING TABLE</span>
<span class="n">tabling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">7</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">indexes</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tabling</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">arr3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">t_meter</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">glmnet</span><span class="p">[</span><span class="n">networks</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
            <span class="n">t_meter</span>    <span class="o">=</span> <span class="n">t_meter</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">tabling</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span>      <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">t_meter</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Metric 3: Networks dispersion (volume))&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">tabling</span><span class="p">,</span>
                        <span class="n">colLabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">indexes</span><span class="p">,</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>

    <span class="c1"># stress on which value is significant against null distribution</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">pvalues</span> <span class="o">=</span> <span class="n">glmnet</span><span class="p">[</span><span class="n">networks</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
    <span class="n">nscore</span>  <span class="o">=</span> <span class="n">pvalues</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

    <span class="n">nbstars</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">row</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span>
        <span class="k">if</span> <span class="n">m</span><span class="o">==</span><span class="mi">4</span> <span class="ow">and</span> <span class="n">row</span> <span class="o">&gt;=</span> <span class="mi">3</span> <span class="p">:</span> <span class="k">continue</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tabling</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="n">nbstars</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nbstars</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">tabling</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1">#     table.auto_set_font_size(False)</span>
<span class="c1">#     table.set_fontsize(5)</span>
<span class="c1">#     table.scale(1.03, 1.03)  # may help</span>
<span class="c1"># plt.suptitle(&quot;Correlation Metric VS Emotion (group) on : {}&quot;.format(moviename))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_34_0.png" src="../_images/notebooks_10_emotion_cohesion_34_0.png" />
</div>
</div>
</section>
</section>
<section id="GLM-reconstruction-of-emotion-from-metric-regressors">
<h3>GLM reconstruction of emotion from metric regressors<a class="headerlink" href="#GLM-reconstruction-of-emotion-from-metric-regressors" title="Permalink to this heading"></a></h3>
<section id="Regressor-Making">
<h4>Regressor Making<a class="headerlink" href="#Regressor-Making" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad_idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">pairs</span> <span class="o">=</span> <span class="p">[(</span><span class="s2">&quot;Vis&quot;</span><span class="p">,</span> <span class="s2">&quot;Default&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;SomMot&quot;</span><span class="p">,</span> <span class="s2">&quot;Default&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;SomMot&quot;</span><span class="p">,</span> <span class="s2">&quot;Vis&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;DorsAttn&quot;</span><span class="p">,</span> <span class="s2">&quot;SalVentAttn&quot;</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;DorsAttn&quot;</span><span class="p">,</span> <span class="s2">&quot;Default&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Limbic&quot;</span><span class="p">,</span> <span class="s2">&quot;Default&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;Cont&quot;</span><span class="p">,</span> <span class="s2">&quot;Default&quot;</span><span class="p">)]</span>
<span class="n">n</span><span class="p">,</span> <span class="n">_</span> <span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">G_movie</span><span class="o">.</span><span class="n">shape</span>
<span class="n">n</span>        <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span> <span class="c1"># window reason we resize by -1</span>

<span class="n">regressors</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
<span class="n">smfactor</span>   <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># #1. Uncomment for inter networks distance</span>
<span class="c1"># for idx, pair in enumerate(pairs):</span>
<span class="c1">#     p1,p2 = pair</span>
<span class="c1">#     y = np.asarray([networks_distance(G_movie[t], G_movie[t], p1, p2)</span>
<span class="c1">#                     for t in range(len(G_movie))])</span>
<span class="c1">#     z1 = zscore(y)</span>
<span class="c1">#     regressors.append(z1[:n])</span>

<span class="c1"># #2. Uncomment for intra networks distance</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">R</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">networks</span><span class="p">):</span>
    <span class="n">y</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">R</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>
    <span class="n">z1</span> <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">regressors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z1</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>

<span class="c1"># #3. Uncomment for explained variance</span>
<span class="c1"># for idx, R in enumerate(networks):</span>
<span class="c1">#     y  = varM[:,idx]</span>
<span class="c1">#     z1 = zscore(y)</span>
<span class="c1">#     regressors.append(z1[:n])</span>

<span class="n">regressors</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">regressors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id1">
<h4>GLM Fitting<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table_t</span>   <span class="o">=</span> <span class="p">{}</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">beta_fit</span>  <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">select</span><span class="p">)):</span>
    <span class="n">emotion</span>    <span class="o">=</span> <span class="n">select</span><span class="p">[</span><span class="n">b</span><span class="p">]</span>
    <span class="n">emo_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">emotion</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
    <span class="n">smoothened</span> <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="n">smfactor</span><span class="p">)</span>
    <span class="n">z2</span>         <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">smoothened</span><span class="p">[:</span><span class="n">n</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>

    <span class="c1"># regress solving</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">regressors</span><span class="o">.</span><span class="n">T</span>

    <span class="n">beta</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">X</span><span class="p">))</span> <span class="o">@</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">y</span>

    <span class="n">y_hat_meter</span> <span class="o">=</span> <span class="n">X</span> <span class="o">@</span> <span class="n">beta</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="n">P</span><span class="p">)</span>

    <span class="n">sigma_hat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_hat_meter</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">df</span>
    <span class="n">design_variance_weight</span> <span class="o">=</span> <span class="n">design_variance</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">residuals</span><span class="p">[</span><span class="n">emotion</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma_hat</span>
    <span class="c1"># t-stats</span>
    <span class="n">t_meter</span>  <span class="o">=</span> <span class="n">beta</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sigma_hat</span> <span class="o">*</span> <span class="n">design_variance_weight</span><span class="p">)</span>

    <span class="c1"># multiply by two to create a two-tailed p-value</span>
    <span class="n">p_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">t</span><span class="p">),</span> <span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>  <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_meter</span><span class="p">])</span>

    <span class="n">table_t</span><span class="p">[</span><span class="n">emotion</span><span class="p">]</span>  <span class="o">=</span> <span class="p">(</span><span class="n">t_meter</span><span class="p">,</span><span class="n">p_values</span><span class="p">)</span>
    <span class="n">beta_fit</span><span class="p">[</span><span class="n">emotion</span><span class="p">]</span> <span class="o">=</span> <span class="n">beta</span>
</pre></div>
</div>
</div>
</section>
<section id="Reconstruction-of-the-original-emotion-timecourse">
<h4>Reconstruction of the original emotion timecourse<a class="headerlink" href="#Reconstruction-of-the-original-emotion-timecourse" title="Permalink to this heading"></a></h4>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zscore</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="s1">&#39;score&#39;</span><span class="p">])),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Example timecourse&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">beta_fit</span><span class="p">[</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="n">regressors</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;combined regressors&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">beta_fit</span><span class="p">[</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])):</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta_fit</span><span class="p">[</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">regressors</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;scaled regressors&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">beta_fit</span><span class="p">[</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]][</span><span class="n">k</span><span class="p">]</span> <span class="o">*</span> <span class="n">regressors</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (TR)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;unitless&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Reconstruction example&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">select</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#39;Reconstruction example&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_41_1.png" src="../_images/notebooks_10_emotion_cohesion_41_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emotions</span> <span class="o">=</span> <span class="n">select</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span>   <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">emotion</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">emotions</span><span class="p">):</span>

    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zscore</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">emotion</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> timecourse&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emotion</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">beta_fit</span><span class="p">[</span><span class="n">emotion</span><span class="p">],</span> <span class="n">regressors</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;combined Regressors&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="c1"># print(stats.pearsonr(np.matmul(beta_fit[emotion], regressors), zscore(np.array(emo_df[emo_df.item==emotion][&#39;score&#39;]))))</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time (TR)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;unitless&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Reconstruct </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">emotion</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_42_0.png" src="../_images/notebooks_10_emotion_cohesion_42_0.png" />
</div>
</div>
</section>
<section id="Metrics/Regressors-auto-correlation">
<h4>Metrics/Regressors auto-correlation<a class="headerlink" href="#Metrics/Regressors-auto-correlation" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[111]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># interest = regressors[1:]</span>
<span class="n">betaindex</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">beta_fit</span><span class="o">.</span><span class="n">values</span><span class="p">()))[:,</span><span class="mi">1</span><span class="p">:])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))[</span><span class="o">-</span><span class="mi">5</span><span class="p">:]</span>
<span class="n">interest</span>  <span class="o">=</span> <span class="n">regressors</span><span class="p">[</span><span class="n">betaindex</span><span class="p">]</span>
<span class="n">regress_corr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">)):</span>
        <span class="n">regress_corr</span><span class="p">[</span><span class="n">k</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">pearsonr</span><span class="p">(</span><span class="n">interest</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">interest</span><span class="p">[</span><span class="n">j</span><span class="p">])</span><span class="o">.</span><span class="n">statistic</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">toremove</span> <span class="o">=</span> <span class="n">regress_corr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">))</span>

<span class="n">arr1</span> <span class="o">=</span> <span class="p">[</span><span class="n">p1</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">p2</span> <span class="k">for</span> <span class="p">(</span><span class="n">p1</span><span class="p">,</span><span class="n">p2</span><span class="p">)</span> <span class="ow">in</span> <span class="n">pairs</span><span class="p">]</span>
<span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vol_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">]</span>
<span class="n">arr4</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;exp_var_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">networks</span><span class="p">))]</span>
<span class="n">metrics_name</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">arr1</span> <span class="o">+</span> <span class="n">arr3</span> <span class="o">+</span> <span class="n">arr4</span> <span class="p">)</span>
<span class="n">x_axis_labels</span> <span class="o">=</span> <span class="n">metrics_name</span><span class="p">[</span><span class="n">betaindex</span><span class="p">]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">regress_corr</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interest</span><span class="p">)),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>  <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xticklabels</span><span class="o">=</span><span class="n">x_axis_labels</span><span class="p">,</span> <span class="n">yticklabels</span><span class="o">=</span><span class="n">x_axis_labels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Extracted dynamic gradients&#39; metrics correlation&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># plt.axis(&#39;off&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[112]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0.5, 1.0, &#34;Extracted dynamic gradients&#39; metrics correlation&#34;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_45_1.png" src="../_images/notebooks_10_emotion_cohesion_45_1.png" />
</div>
</div>
</section>
<section id="t-statistics-of-Beta-Coefficients">
<h4>t-statistics of Beta Coefficients<a class="headerlink" href="#t-statistics-of-Beta-Coefficients" title="Permalink to this heading"></a></h4>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[116]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># arr1 = [p1+&#39;_&#39;+p2 for (p1,p2) in pairs]</span>
<span class="c1"># arr2 = [&quot;1d_var_{}&quot;.format(n) for n in networks]</span>
<span class="n">arr3</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vol_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">]</span>
<span class="c1"># arr4 = [&quot;exp_var_{}&quot;.format(n) for n in range(len(networks))]</span>
<span class="c1"># metrics_name = [&#39;intercept&#39;] + arr1 + arr2 + arr3 + arr4</span>
<span class="n">metrics_name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;intercept&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">arr3</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[118]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.font_manager</span> <span class="kn">import</span> <span class="n">FontProperties</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>

<span class="n">tabling</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">metrics_name</span><span class="p">),</span><span class="mi">13</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">metrics_name</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">tabling</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">metrics_name</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">emotion</span> <span class="o">=</span> <span class="n">select</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="n">tabling</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">table_t</span><span class="p">[</span><span class="n">emotion</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>


<span class="n">table</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">cellText</span><span class="o">=</span><span class="n">tabling</span><span class="p">,</span>
                        <span class="n">colLabels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">s</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">select</span><span class="p">],</span>
                        <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">),</span> <span class="n">cell</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">get_celld</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">row</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">col</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>

    <span class="n">emotion</span> <span class="o">=</span> <span class="n">select</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

    <span class="c1"># stress on which value is significant against null distribution</span>
    <span class="n">nscore</span>  <span class="o">=</span> <span class="n">table_t</span><span class="p">[</span><span class="n">emotion</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">nbstars</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.01</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">nscore</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">row</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">col</span> <span class="o">!=</span><span class="mi">0</span> <span class="p">:</span>
        <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tabling</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="n">nbstars</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nbstars</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cell</span><span class="o">.</span><span class="n">set_text_props</span><span class="p">(</span><span class="n">fontproperties</span><span class="o">=</span><span class="n">FontProperties</span><span class="p">(</span><span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">float</span><span class="p">(</span><span class="n">tabling</span><span class="p">[</span><span class="n">row</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">col</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">cell</span><span class="o">.</span><span class="n">get_text</span><span class="p">()</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="n">table</span><span class="o">.</span><span class="n">auto_set_font_size</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">table</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[118]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.0, 1.0, 0.0, 1.0)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_48_1.png" src="../_images/notebooks_10_emotion_cohesion_48_1.png" />
</div>
</div>
<p>### Visualization of correlation between metrics and actual movie with emotion series on the side Details : Look at on correlation metric strong correlation, 2d joint plot moving over time (with some highlights) versus movie emotions timeseries. We choose here: - Emotion : Anger - Network : Dorsal Attention - Metric : Volume Change</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">moviepy.editor</span> <span class="k">as</span> <span class="nn">mp</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. Loading Gradient Example</span>
<span class="n">networks</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">index2region</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">moviename</span> <span class="o">=</span> <span class="s1">&#39;Sintel&#39;</span>

<span class="n">G_movie</span><span class="p">,</span> <span class="n">varM</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="s1">&#39;./resources/dynamic_grad/group_level414/</span><span class="si">{}</span><span class="s1">_40_grad.pkl&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level_otherparam/{}_40_1_grad.pkl&#39;.format(moviename))</span>
<span class="c1"># G_movie, varM = load(&#39;./resources/dynamic_grad/group_level_otherparam/{}_80_2_grad.pkl&#39;.format(moviename))</span>
<span class="n">G_movie</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[:,:,:</span><span class="mi">3</span><span class="p">]</span>

<span class="c1"># 2. Loading Matching Emotion Track</span>
<span class="n">full_df</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./data/emotion_compileBIDS.csv&#39;</span><span class="p">)</span>
<span class="n">emo_df</span>   <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>
<span class="n">other_df</span> <span class="o">=</span> <span class="n">full_df</span><span class="p">[</span><span class="n">full_df</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;W_</span><span class="si">{}</span><span class="s1">13.csv&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compute Metric series</span>
<span class="n">tmp_emo</span> <span class="o">=</span> <span class="s1">&#39;Happiness&#39;</span>
<span class="n">net</span>     <span class="o">=</span> <span class="s1">&#39;SalVentAttn&#39;</span>

<span class="n">ym</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">t</span><span class="p">],</span> <span class="n">net</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))])</span>

<span class="c1"># Find Emotion series</span>
<span class="n">emo_series</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">emo_df</span><span class="p">[</span><span class="n">emo_df</span><span class="o">.</span><span class="n">item</span><span class="o">==</span><span class="n">tmp_emo</span><span class="p">][</span><span class="s1">&#39;score&#39;</span><span class="p">])</span>
<span class="n">smoothened</span> <span class="o">=</span> <span class="n">overlap_add</span><span class="p">(</span><span class="n">emo_series</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ye</span>   <span class="o">=</span> <span class="n">zscore</span><span class="p">(</span><span class="n">smoothened</span><span class="p">[:</span><span class="n">ym</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We want to extract a quick snippet of emotion/metric and watch the corresponding video snippet</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zscore</span><span class="p">(</span><span class="n">ym</span><span class="p">))</span>
<span class="c1"># plt.plot(-ym)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ye</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zscore</span><span class="p">(</span><span class="n">smoothened</span><span class="p">))</span>
<span class="c1"># plt.xlim(400,490)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Transition of interest for: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;TR (time)&#39;</span><span class="p">)</span>
<span class="c1"># We select our snippet to be showing 1 sharp transition, i.e from TR 220 to TR 235 which would give us 15 * TR seconds of movies</span>
<span class="n">moviestart</span> <span class="o">=</span> <span class="n">TR</span> <span class="o">*</span> <span class="mi">135</span>
<span class="n">movieend</span>   <span class="o">=</span> <span class="n">TR</span> <span class="o">*</span> <span class="mi">175</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">135</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interest start&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">175</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;interest end&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.legend.Legend at 0x7ff4a00f7fd0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_53_1.png" src="../_images/notebooks_10_emotion_cohesion_53_1.png" />
</div>
</div>
<p>Loading Images</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fps</span> <span class="o">=</span> <span class="mi">24</span>
<span class="n">start_idx</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">moviestart</span> <span class="o">*</span> <span class="n">fps</span><span class="p">)</span>
<span class="n">end_idx</span>   <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">movieend</span> <span class="o">*</span> <span class="n">fps</span><span class="p">)</span>

<span class="n">frames</span> <span class="o">=</span> <span class="n">video2img</span><span class="p">(</span><span class="s1">&#39;./data/zeal/Sintel_zeal_Surprise.mp4&#39;</span><span class="p">,</span> <span class="n">start_idx</span><span class="o">=</span><span class="n">start_idx</span><span class="p">,</span> <span class="n">end_idx</span><span class="o">=</span><span class="n">end_idx</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Display FPS is: 24.0
</pre></div></div>
</div>
<p>Adding audio</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_clip</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">VideoFileClip</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;./data/zeal/Sintel_zeal_Surprise.mp4&quot;</span><span class="p">)</span>
<span class="c1"># my_clip.audio.write_audiofile(&quot;/tmp/data/test.wav&quot;,codec=&#39;pcm_s16le&#39;)</span>
<span class="n">tmp_clip</span> <span class="o">=</span> <span class="n">my_clip</span><span class="o">.</span><span class="n">subclip</span><span class="p">(</span><span class="n">moviestart</span><span class="p">,</span> <span class="n">movieend</span><span class="p">)</span>
<span class="n">tmp_clip</span><span class="o">.</span><span class="n">audio</span><span class="o">.</span><span class="n">write_audiofile</span><span class="p">(</span><span class="s2">&quot;./data/zeal/audio.wav&quot;</span><span class="p">,</span> <span class="n">codec</span><span class="o">=</span><span class="s2">&quot;pcm_s32le&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoviePy - Writing audio in ./data/zeal/audio.wav
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MoviePy - Done.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="n">pal</span>     <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="n">frame</span>  <span class="o">=</span> <span class="mi">100</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">net</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">networks</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">net</span> <span class="o">==</span> <span class="s1">&#39;SalVentAttn&#39;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>

        <span class="n">C1</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">C2</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span> <span class="o">+</span> <span class="s1">&#39;_Centroid&#39;</span><span class="p">)</span>

        <span class="n">R</span> <span class="o">=</span> <span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">][:,:</span><span class="mi">2</span><span class="p">],</span> <span class="n">net</span><span class="p">)</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Volume Metric&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

        <span class="c1"># adding metric circle from the first frame to give a sense of change</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="mi">0</span><span class="p">][:,:</span><span class="mi">2</span><span class="p">],</span> <span class="n">net</span><span class="p">)</span>
        <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Volume Metric&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>


<span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
<span class="n">order</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="c1"># legend = ax.legend([handles[idx] for idx in order],[labels[idx] for idx in order], loc=1, prop={&#39;size&#39;:16})</span>
<span class="k">for</span> <span class="n">lh</span> <span class="ow">in</span> <span class="n">legend</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">:</span>
    <span class="n">lh</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Gradient Network Topology&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Text(0, 0.5, &#39;G2&#39;)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_58_1.png" src="../_images/notebooks_10_emotion_cohesion_58_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the corresponding joint plot video</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">ListedColormap</span>
<span class="n">pal</span>     <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">color_palette</span><span class="p">(</span><span class="s1">&#39;colorblind&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">ListedColormap</span><span class="p">(</span><span class="n">pal</span><span class="p">)</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">G_movie</span><span class="p">))):</span>
    <span class="n">frame</span>  <span class="o">=</span> <span class="n">j</span>
    <span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">net</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">networks</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">net</span> <span class="o">==</span> <span class="s1">&#39;SalVentAttn&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>

            <span class="n">C1</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">C2</span> <span class="o">=</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span> <span class="o">+</span> <span class="s1">&#39;_Centroid&#39;</span><span class="p">)</span>

            <span class="n">R</span> <span class="o">=</span> <span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">][:,:</span><span class="mi">2</span><span class="p">],</span> <span class="n">net</span><span class="p">)</span>
            <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Volume Metric&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>

            <span class="c1"># adding metric circle from the first frame to give a sense of change</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">network_volume</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="mi">435</span><span class="p">][:,:</span><span class="mi">2</span><span class="p">],</span> <span class="n">net</span><span class="p">)</span>
            <span class="n">circle</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="n">C1</span><span class="p">,</span> <span class="n">C2</span><span class="p">),</span> <span class="n">R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Volume Metric&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">circle</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">0</span><span class="p">],</span> <span class="n">G_movie</span><span class="p">[</span><span class="n">frame</span><span class="p">,</span><span class="n">index2region</span><span class="p">[</span><span class="n">net</span><span class="p">],</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">color</span><span class="o">=</span><span class="n">my_cmap</span><span class="o">.</span><span class="n">colors</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">net</span><span class="p">)</span>


    <span class="n">handles</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_legend_handles_labels</span><span class="p">()</span>
    <span class="n">order</span>  <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
    <span class="c1"># legend = ax.legend([handles[idx] for idx in order],[labels[idx] for idx in order], loc=1, prop={&#39;size&#39;:8})</span>
    <span class="c1"># for lh in legend.legendHandles:</span>
    <span class="c1">#     lh.set_alpha(1)</span>
    <span class="c1"># ax.set_title(&quot;Gradient Network Topology&quot;)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span><span class="mi">25</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;./media/gradient_plots/</span><span class="si">{}</span><span class="s2">_</span><span class="si">{}</span><span class="s2">.jpg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">,</span><span class="n">j</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">(</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
100%|██████████| 556/556 [01:26&lt;00:00,  6.41it/s]
</pre></div></div>
</div>
<p>Combination of plots</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># path = &quot;./media/gradient_plots/&quot;</span>

<span class="c1"># # reorder saved images path</span>
<span class="c1"># movie_path  = loadimg_in_order([m for m in os.listdir(path)])</span>
<span class="c1"># movie_array = [cv2.imread(path+&#39;/&#39;+filename) for filename in movie_path]</span>

<span class="c1"># img2video(movie_array, 10, outpath_name=&#39;./media/{}_attention_ws{}.mp4&#39;.format(moviename,40))</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s combine the images</span>
<span class="n">nbdup</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span><span class="o">//</span><span class="mi">40</span>
<span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span><span class="mi">175</span><span class="p">):</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./media/gradient_plots/</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.jpg&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">moviename</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nbdup</span><span class="p">):</span>
        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>

<span class="n">images</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
<span class="n">frames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>

<span class="n">padimages</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">,(</span><span class="mi">800</span><span class="p">,</span><span class="mi">544</span><span class="p">))[:,:,::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">))])</span>
<span class="n">merged</span>    <span class="o">=</span> <span class="n">compare_videos</span><span class="p">(</span><span class="n">frames</span><span class="p">[:,:,:,::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">padimages</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">merged</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7ff4f338e610&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_10_emotion_cohesion_63_1.png" src="../_images/notebooks_10_emotion_cohesion_63_1.png" />
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img2video</span><span class="p">(</span><span class="n">merged</span><span class="p">[:,:,:,::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;24fps.mp4&#39;</span><span class="p">)</span>
<span class="c1"># img2video(merged[:,:,:,::-1], 72,&#39; 72fps.mp4&#39;)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
OpenCV: FFMPEG: tag 0x5634504d/&#39;MP4V&#39; is not supported with codec id 12 and format &#39;mp4 / MP4 (MPEG-4 Part 14)&#39;
OpenCV: FFMPEG: fallback to use tag 0x7634706d/&#39;mp4v&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="09_gradient_films_order.html" class="btn btn-neutral float-left" title="9. Ordering based on Gradients" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="11_emotion_networks.html" class="btn btn-neutral float-right" title="11. Emotion Count across Networks" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Michael Chan.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>